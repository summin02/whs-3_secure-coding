<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ì í˜ì´ì§€</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
        <h3 class="navbar-brand mb-2">ğŸ‘‘ ê´€ë¦¬ì í˜ì´ì§€</h3>
    </nav>

<div class="container mt-5">
    <!-- âœ… ê´€ë¦¬ì ëª©ë¡ -->
    <h5 class="mt-4">ğŸ”§ ê´€ë¦¬ì ê³„ì •</h5>
    <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>ì´ë©”ì¼</th>
            <th>ë‹‰ë„¤ì„</th>
            <th>ê¶Œí•œ</th>
            {% if session.is_superadmin %}
                <th><strong>ê¶Œí•œ ê´€ë¦¬</strong></th> <!-- ì—¬ê¸°ê°€ ê·¸ ì—´ -->
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for user in admins %}
          <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.nickname }}</td>
            <td>ğŸ‘‘ ê´€ë¦¬ì</td>
              {% if session.is_superadmin %}
                <td>
                    <form method="POST" action="/admin/demote/{{ user.id }}">
                        <button class="btn btn-sm btn-outline-danger">ğŸ”¥ ê´€ë¦¬ì í•´ì œ</button>
                    </form>
                </td>
              {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>

    <!-- âœ… ì¼ë°˜ ì‚¬ìš©ì ëª©ë¡ -->
    <h5 class="mt-5">ğŸ‘¥ ì¼ë°˜ ì‚¬ìš©ì</h5>
    <table class="table table-bordered mt-2 bg-white">
        <thead>
            <tr>
                <th>ID</th>
                <th>ì´ë©”ì¼</th>
                <th>ë‹‰ë„¤ì„</th>
                <th>ìƒíƒœ</th>
                <th>ê´€ë¦¬</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.nickname }}</td>
                <td>
                    {% if user.is_blocked %}
                        ğŸ”’ ì°¨ë‹¨ë¨<br>
                        <small class="text-muted">ì‚¬ìœ : {{ user.block_reason or 'ì—†ìŒ' }}</small>
                    {% else %}
                        âœ… ì •ìƒ
                    {% endif %}
                </td>
                <td>
                    {% if user.is_blocked %}
                        <form method="POST" action="/admin/block/{{ user.id }}">
                            <button class="btn btn-sm btn-success">ì°¨ë‹¨ í•´ì œ</button>
                        </form>
                    {% else %}
                        <form method="POST" action="/admin/block/{{ user.id }}">
                            <div class="d-flex align-items-center gap-2">
                                <select name="reason" class="form-select form-select-sm" required>
                                    <option value="">ì‚¬ìœ  ì„ íƒ</option>
                                    <option>ìš•ì„¤ ë° ë¹„ë§¤ë„ˆ</option>
                                    <option>ì‚¬ê¸° ì˜ì‹¬</option>
                                    <option>ê¸°íƒ€</option>
                                </select>
                                <button class="btn btn-sm btn-danger">ì°¨ë‹¨</button>
                            </div>
                        </form>
                    {% endif %}
                    {% if session.is_superadmin %}
                    {% if not user.is_admin %}
                        <form method="POST" action="/admin/promote/{{ user.id }}">
                            <button class="btn btn-sm btn-outline-success">ğŸ‘‘ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬</button>
                        </form>
                    {% else %}
                        <span class="badge bg-success">ê´€ë¦¬ì</span>
                    {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}

        </tbody>
    </table>

    <h5 class="mt-5">ğŸ‘¥ ì‚¬ìš©ì ì”ì•¡ ìˆ˜ì •</h5>
    <table class="table table-bordered mt-2 bg-white">
        <thead>
            <tr>
                <th>ID</th>
                <th>ë‹‰ë„¤ì„</th>
                <th>ì´ë©”ì¼</th>
                <th>ì”ì•¡</th>
                <th>ê´€ë¦¬</th>
            </tr>
        </thead>
        <tbody>
            {% for user in admins %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.nickname }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.balance }}ì›</td>
                <td>
                    {% if session.is_superadmin %}
                        <!-- ìŠˆí¼ ê´€ë¦¬ìë§Œ ì”ì•¡ ìˆ˜ì • ë²„íŠ¼ì„ ë³¼ ìˆ˜ ìˆë„ë¡ -->
                        <a href="/admin/users/edit_balance/{{ user.id }}" class="btn btn-sm btn-warning">ì”ì•¡ ìˆ˜ì •</a>
                    {% else %}
                        <span>ê¶Œí•œ ì—†ìŒ</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            {% for user in users %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.nickname }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.balance }}ì›</td>
                <td>
                    {% if session.is_superadmin %}
                        <!-- ìŠˆí¼ ê´€ë¦¬ìë§Œ ì”ì•¡ ìˆ˜ì • ë²„íŠ¼ì„ ë³¼ ìˆ˜ ìˆë„ë¡ -->
                        <a href="/admin/users/edit_balance/{{ user.id }}" class="btn btn-sm btn-warning">ì”ì•¡ ìˆ˜ì •</a>
                    {% else %}
                        <span>ê¶Œí•œ ì—†ìŒ</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <table class="table">
        <thead>
            <tr>
                <th>êµ¬ë§¤ì</th>
                <th>ìƒí’ˆ</th>
                <th>êµ¬ë§¤ì¼</th>
            </tr>
        </thead>
        <tbody>
            {% for purchase in purchases %}
            <tr>
                <td>{{ purchase.nickname }}</td>
                <td>{{ purchase.title }}</td>
                <td>{{ purchase.purchase_date }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <a href="/" class="btn btn-secondary btn-sm mt-3">â† ë©”ì¸ìœ¼ë¡œ</a>
    <a href="/admin/logs" class="btn btn-outline-dark btn-sm mt-3">ğŸ” ë¡œê·¸ ë³´ê¸°</a>
    <a href="/admin/items" class="btn btn-outline-primary btn-sm mt-3">ğŸ“¦ ê²Œì‹œë¬¼ ê´€ë¦¬</a>
    
</div>
</body>
</html>